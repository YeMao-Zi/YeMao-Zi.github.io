(window.webpackJsonp=window.webpackJsonp||[]).push([[219],{599:function(t,s,a){"use strict";a.r(s);var e=a(5),p=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("我们写过很多 Module、Service、Controller，但这些都要服务跑起来之后在浏览器里访问对应的 url，通过 get 或者 post 的方式传参来测试。")]),t._v(" "),s("p",[t._v("这个还是挺麻烦的，能不能像 node 的 repl 那样，直接在控制台测试呢？")]),t._v(" "),s("p",[t._v("repl 是 read-eval-paint-loop，也就是这个：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/777cf2c0ab8b4f648dc795a37f320162~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=566&h=482&s=51437&e=png&b=000000",alt:""}})]),t._v(" "),s("p",[t._v("Nest 能不能这样来测试呢？")]),t._v(" "),s("p",[t._v("可以的，Nest 支持 repl 模式。")]),t._v(" "),s("p",[t._v("我们创建个 Nest 项目：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("nest new repl-test\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/137a3efc322e4e26ba648fb4a617f2f9~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=840&h=642&s=141942&e=png&b=010101",alt:""}})]),t._v(" "),s("p",[t._v("然后创建两个模块：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6754d51a50bb4e16866d1c4483ba3c2b~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=926&h=1016&s=239764&e=png&b=191919",alt:""}})]),t._v(" "),s("p",[t._v("把服务跑起来：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm run start:dev\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/086be719b6654c86a246a2858423b588~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1704&h=994&s=451390&e=png&b=181818",alt:""}})]),t._v(" "),s("p",[t._v("浏览器访问下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c09659fd4f4649f59ad5f9ba34369c4c~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=600&h=182&s=19289&e=png&b=ffffff",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0d3997c6ede4de5a952612758bd4505~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=604&h=204&s=19983&e=png&b=ffffff",alt:""}})]),t._v(" "),s("p",[t._v("我们前面都是这么测试接口的。")]),t._v(" "),s("p",[t._v("其实还可以用 repl 模式。")]),t._v(" "),s("p",[t._v("在 src 下创建个 repl.ts，写入如下内容：")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" repl "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@nestjs/core'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" AppModule "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./app.module'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bootstrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("repl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AppModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bootstrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("p",[t._v("然后把服务停掉，通过这种方式跑：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm run start:dev -- --entryFile repl\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("这里的 --entryFile 是指定入口文件是 repl.ts")]),t._v(" "),s("p",[t._v("前面带了个 -- 是指后面的参数不是传给 npm run start:dev 的，要原封不动保留。")]),t._v(" "),s("p",[t._v("也就是会传给 nest start")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2b21e78e1a14452c80196ae20c545812~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=690&h=114&s=25838&e=png&b=202020",alt:""}})]),t._v(" "),s("p",[t._v("当然，你直接执行 nest start 也可以：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("nest start --watch --entryFile repl\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("跑起来后，执行 debug()，会打印所有的 module 和 module 下的 controllers 和 providers。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2b15e5eb0e5b474db29720e3211d9a9d~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=588&h=794&s=87297&e=png&b=181818",alt:""}})]),t._v(" "),s("p",[t._v("而且，你可以 get() 来取对应的 providers 或者 controllers 调用：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ebfcd94265ab490a8d31e3ebf6b542f5~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1062&h=698&s=116051&e=png&b=1c1c1c",alt:""}})]),t._v(" "),s("p",[t._v("get、post 方法都可以调用。")]),t._v(" "),s("p",[t._v("有的同学说，你这个 post 方法没有参数啊。")]),t._v(" "),s("p",[t._v("那我们加一些：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cdf7f5845e854489b829e8186aac5695~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=690&h=286&s=36309&e=png&b=1f1f1f",alt:""}})]),t._v(" "),s("p",[t._v("然后添加 ValidationPipe：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01be04999b794519b5e3fdf793c37b82~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1046&h=612&s=127403&e=png&b=1f1f1f",alt:""}})]),t._v(" "),s("p",[t._v("安装校验相关的包：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm install class-validator class-transformer\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("在 dto 添加约束：")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" IsEmail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" IsNotEmpty "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"class-validator"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CreateAaaDto")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    @"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("IsNotEmpty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("aaa")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    @"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("IsEmail")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("bbb")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[t._v("我们先正常跑下服务：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm run start:dev\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("然后 postman 里测试下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c14f46a195014e37b9c954d504fbfb5c~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=788&h=838&s=83951&e=png&b=fcfcfc",alt:""}})]),t._v(" "),s("p",[t._v("可以看到，ValidationPipe 生效了。")]),t._v(" "),s("p",[t._v("那 repl 里是不是一样呢？")]),t._v(" "),s("p",[t._v("我们再跑下 repl 模式：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm run start:dev -- --entryFile repl\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("可以看到，并没有触发 pipe：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bfd8ec0cd0ff4570b7a77d1794988bcd~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1098&h=804&s=167939&e=png&b=1b1b1b",alt:""}})]),t._v(" "),s("p",[t._v("也就是说，它只是单纯的传参调用这个函数，不会解析装饰器。")]),t._v(" "),s("p",[t._v("所以测试 controller 的话，repl 的方式是有一些限制的。")]),t._v(" "),s("p",[t._v("但是测试 service 很不错：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/637e0aaca9bd4ffca0ea475da193c2bc~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=644&h=214&s=26237&e=png&b=181818",alt:""}})]),t._v(" "),s("p",[t._v("比如测试某个项目的 UserService 的 login 方法：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c56f9d0f87ac40a5978c5f47ecd902fa~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1534&h=1422&s=336812&e=png&b=191919",alt:""}})]),t._v(" "),s("p",[t._v("就很方便。")]),t._v(" "),s("p",[t._v("大概知道 repl 模式是做啥的之后，我们过一下常用的 api：")]),t._v(" "),s("p",[t._v("debug() 可以查看全部的 module 或者某个 module 下的 cotrollers、providers：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/47567c24da6341bb93687460679247a5~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=466&h=644&s=62438&e=png&b=181818",alt:""}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a8bf9ec2ffbd40a8a1b9b97fc276aa44~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=426&h=296&s=28159&e=png&b=181818",alt:""}})]),t._v(" "),s("p",[t._v("methods() 可以查看某个 controller 或者 provider 的方法：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/843e3284b7444bff885c5a825cf853a0~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=530&h=338&s=27089&e=png&b=181818",alt:""}})]),t._v(" "),s("p",[t._v("get() 或者 $() 可以拿到某个 controller 或者 provider 调用它的方法：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e4482f8468f4657aa76e08100e363d1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=800&h=288&s=40856&e=png&b=181818",alt:""}})]),t._v(" "),s("p",[t._v("常用的 api 就这些。")]),t._v(" "),s("p",[t._v("此外，按住上下键可以在历史命令中导航：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/981e59361f9e45b0b425cdedcf8e0bd3~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1234&h=718&s=96689&e=gif&f=26&b=191919",alt:""}})]),t._v(" "),s("p",[t._v("但有个问题。")]),t._v(" "),s("p",[t._v("当你重新跑之后，这些命令历史就消失了，再按上下键也没有历史。")]),t._v(" "),s("p",[t._v("可以改一下 repl.ts：")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" repl "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@nestjs/core'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" AppModule "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./app.module'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bootstrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" replServer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("repl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AppModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    replServer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setupHistory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('".nestjs_repl_history"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("bootstrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("再跑的时候也是有历史的：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d9ffa40680b4004a7f84bba633b0524~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1572&h=764&s=319655&e=gif&f=42&b=191919",alt:""}})]),t._v(" "),s("p",[t._v("其实就是 nest 会把历史命令写入文件里，下一次跑就可以用它恢复历史了：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7adf2d8d4d024957b788c25fd46cf2af~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=482&h=272&s=27250&e=png&b=1f1f1f",alt:""}})]),t._v(" "),s("p",[t._v("你还可以把这个命令配到 npm scripts 里：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8da4ff55b144c98b61c6a4ab7af0873~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=924&h=114&s=25935&e=png&b=202020",alt:""}})]),t._v(" "),s("p",[t._v("然后直接 npm run repl:dev 来跑。")]),t._v(" "),s("p",[t._v("案例代码上传了"),s("a",{attrs:{href:"https://github.com/QuarkGluonPlasma/nestjs-course-code/tree/main/repl-login",target:"_blank",rel:"noopener noreferrer"}},[t._v("小册仓库"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("这节我们学了 nest 的 repl 模式。")]),t._v(" "),s("p",[t._v("repl 模式下可以直接调用 controller 或者 provider 的方法，但是它们并不会触发 pipe、interceptor 等，只是传参测试函数。")]),t._v(" "),s("p",[t._v("可以使用 debug() 拿到 module、controller、provider 的信息，methods() 拿到方法，然后 get() 或者 $() 拿到 controller、provider 然后调用。")]),t._v(" "),s("p",[t._v("repl 模式对于测试 service 或者 contoller 的功能还是很有用的。")])])}),[],!1,null,null,null);s.default=p.exports}}]);